
<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    {% load static %}
    <link rel='stylesheet' type='text/css' media='screen' href="{% static 'SEC_App/style.css' %}">
    <!-- <script src="{% static 'SEC_App/reactions_chart.js' %}" defer></script> -->

    <!-- Tajawal font -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal&display=swap" rel="stylesheet">

    <!-- chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.3.2/chart.min.js" ></script>
    

</head>
<body>  
  
  <img src="{% static 'SEC_App/wordcloud.png' %}" alt="wordcloud" >
  
  <div id="myCahrt-container">
    <canvas id="reactions-bar-chart" width="30%" height="30%" style='display: "inline-block" !important;'></canvas>
  </div>
  <div id='tweets-list'>
  <h2>التغريدات</h2>
    <table>
      <ol>
    {% for tweet in tweets_list %}
        <tr>
          <td><li></li></td>
          <td>{{ tweet }}</td>
        </tr>
    {% endfor %}
    </ol>
    </table>
  </div>

</body>
</html>
<script>
  var reactions = JSON.parse("{{ reactions|escapejs }}");

  var likes = reactions['likes'];
  var replies = reactions['replies'];
  var retweets = reactions['retweets'];


  var ctx = document.getElementById("reactions-bar-chart");

  // setup
  const DATA_COUNT = 3;

  const labels = ['سلبي', 'طبيعي', 'إيجابي'];
  const data = {
    labels: labels,
    datasets: [
      {
        label: 'إعجابات',
        data: likes,
        backgroundColor: 'rgba(255, 206, 86, 0.2)', 
        borderColor: 'rgba(255, 206, 86, 1)',
        borderWidth: 1
      },
      {
        label: 'إعادات التغريد',
        data: retweets,
        backgroundColor: 'rgba(54, 162, 235, 0.2)',
        borderColor: 'rgba(54, 162, 235, 1)',
        borderWidth: 1
      },
      {
        label: 'الردود',
        data: replies,
        backgroundColor: 'rgba(255, 99, 132, 0.2)',
        borderColor: 'rgba(255, 99, 132, 1)',
        borderWidth: 1
      },
    ]
  };

  // config
  const config = {
      type: 'bar',
      data: data,
      options: {
        plugins: {
          title: {
            display: true,
            text: 'التفاعل مع التغريدات',
            fontColor: 'rgba(240, 248, 255, 1)',
          },
        },
        responsive: true,
        scales: {
          x: {
            stacked: true,
            ticks: {
              fontColor: 'rgba(240, 248, 255, 1)',
            },
          },
          y: {
            stacked: true,
            ticks: {
              fontColor: 'rgba(240, 248, 255, 1)',
            },
          }
        }
      }
    };
  // 'rgba(240, 248, 255, 1)'
  // action
  const actions = [
      {
        name: 'Randomize',
        handler(chart) {
          chart.data.datasets.forEach(dataset => {
            dataset.data = Utils.numbers({count: chart.data.labels.length, min: 0});
          });
          chart.update();
        }
      },
    ];

  var chart = new Chart(ctx, config, actions)
</script>